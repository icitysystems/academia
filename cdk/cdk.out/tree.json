{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.233.0"},"children":{"AcademiaSharedDatabase":{"id":"AcademiaSharedDatabase","path":"AcademiaSharedDatabase","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"SharedVpc":{"id":"SharedVpc","path":"AcademiaSharedDatabase/SharedVpc","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.Vpc","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaSharedDatabase/SharedVpc/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPC","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPC","aws:cdk:cloudformation:props":{"cidrBlock":"10.0.0.0/16","enableDnsHostnames":true,"enableDnsSupport":true,"instanceTenancy":"default","tags":[{"key":"Name","value":"academia-shared-vpc"}]}}},"PublicSubnet1":{"id":"PublicSubnet1","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.233.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1a","cidrBlock":"10.0.0.0/24","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"AcademiaSharedDatabase/SharedVpc/PublicSubnet1"}],"vpcId":{"Ref":"SharedVpc96F0F614"}}}},"Acl":{"id":"Acl","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"AcademiaSharedDatabase/SharedVpc/PublicSubnet1"}],"vpcId":{"Ref":"SharedVpc96F0F614"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"SharedVpcPublicSubnet1RouteTableB2E560ED"},"subnetId":{"Ref":"SharedVpcPublicSubnet1SubnetE66A2D86"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet1/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"SharedVpcIGW869E5885"},"routeTableId":{"Ref":"SharedVpcPublicSubnet1RouteTableB2E560ED"}}}}}},"PublicSubnet2":{"id":"PublicSubnet2","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PublicSubnet","version":"2.233.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1b","cidrBlock":"10.0.1.0/24","mapPublicIpOnLaunch":true,"tags":[{"key":"aws-cdk:subnet-name","value":"Public"},{"key":"aws-cdk:subnet-type","value":"Public"},{"key":"Name","value":"AcademiaSharedDatabase/SharedVpc/PublicSubnet2"}],"vpcId":{"Ref":"SharedVpc96F0F614"}}}},"Acl":{"id":"Acl","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"AcademiaSharedDatabase/SharedVpc/PublicSubnet2"}],"vpcId":{"Ref":"SharedVpc96F0F614"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"SharedVpcPublicSubnet2RouteTableF58D8939"},"subnetId":{"Ref":"SharedVpcPublicSubnet2SubnetE33911D4"}}}},"DefaultRoute":{"id":"DefaultRoute","path":"AcademiaSharedDatabase/SharedVpc/PublicSubnet2/DefaultRoute","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRoute","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Route","aws:cdk:cloudformation:props":{"destinationCidrBlock":"0.0.0.0/0","gatewayId":{"Ref":"SharedVpcIGW869E5885"},"routeTableId":{"Ref":"SharedVpcPublicSubnet2RouteTableF58D8939"}}}}}},"IsolatedSubnet1":{"id":"IsolatedSubnet1","path":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet1","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.233.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet1/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1a","cidrBlock":"10.0.2.0/24","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Isolated"},{"key":"aws-cdk:subnet-type","value":"Isolated"},{"key":"Name","value":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet1"}],"vpcId":{"Ref":"SharedVpc96F0F614"}}}},"Acl":{"id":"Acl","path":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet1/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet1/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet1"}],"vpcId":{"Ref":"SharedVpc96F0F614"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet1/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"SharedVpcIsolatedSubnet1RouteTable562E4FE1"},"subnetId":{"Ref":"SharedVpcIsolatedSubnet1Subnet2FB46B24"}}}}}},"IsolatedSubnet2":{"id":"IsolatedSubnet2","path":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet2","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.PrivateSubnet","version":"2.233.0","metadata":[]},"children":{"Subnet":{"id":"Subnet","path":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet2/Subnet","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnet","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::Subnet","aws:cdk:cloudformation:props":{"availabilityZone":"us-east-1b","cidrBlock":"10.0.3.0/24","mapPublicIpOnLaunch":false,"tags":[{"key":"aws-cdk:subnet-name","value":"Isolated"},{"key":"aws-cdk:subnet-type","value":"Isolated"},{"key":"Name","value":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet2"}],"vpcId":{"Ref":"SharedVpc96F0F614"}}}},"Acl":{"id":"Acl","path":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet2/Acl","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"RouteTable":{"id":"RouteTable","path":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet2/RouteTable","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnRouteTable","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::RouteTable","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet2"}],"vpcId":{"Ref":"SharedVpc96F0F614"}}}},"RouteTableAssociation":{"id":"RouteTableAssociation","path":"AcademiaSharedDatabase/SharedVpc/IsolatedSubnet2/RouteTableAssociation","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSubnetRouteTableAssociation","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SubnetRouteTableAssociation","aws:cdk:cloudformation:props":{"routeTableId":{"Ref":"SharedVpcIsolatedSubnet2RouteTable4B21FD77"},"subnetId":{"Ref":"SharedVpcIsolatedSubnet2Subnet96BA40FA"}}}}}},"IGW":{"id":"IGW","path":"AcademiaSharedDatabase/SharedVpc/IGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnInternetGateway","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::InternetGateway","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"academia-shared-vpc"}]}}},"VPCGW":{"id":"VPCGW","path":"AcademiaSharedDatabase/SharedVpc/VPCGW","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCGatewayAttachment","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCGatewayAttachment","aws:cdk:cloudformation:props":{"internetGatewayId":{"Ref":"SharedVpcIGW869E5885"},"vpcId":{"Ref":"SharedVpc96F0F614"}}}},"SecretsManagerEndpoint":{"id":"SecretsManagerEndpoint","path":"AcademiaSharedDatabase/SharedVpc/SecretsManagerEndpoint","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.InterfaceVpcEndpoint","version":"2.233.0","metadata":[]},"children":{"SecurityGroup":{"id":"SecurityGroup","path":"AcademiaSharedDatabase/SharedVpc/SecretsManagerEndpoint/SecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaSharedDatabase/SharedVpc/SecretsManagerEndpoint/SecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"AcademiaSharedDatabase/SharedVpc/SecretsManagerEndpoint/SecurityGroup","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"securityGroupIngress":[{"cidrIp":{"Fn::GetAtt":["SharedVpc96F0F614","CidrBlock"]},"ipProtocol":"tcp","fromPort":443,"toPort":443,"description":{"Fn::Join":["",["from ",{"Fn::GetAtt":["SharedVpc96F0F614","CidrBlock"]},":443"]]}}],"tags":[{"key":"Name","value":"academia-shared-vpc"}],"vpcId":{"Ref":"SharedVpc96F0F614"}}}}}},"Resource":{"id":"Resource","path":"AcademiaSharedDatabase/SharedVpc/SecretsManagerEndpoint/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnVPCEndpoint","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::VPCEndpoint","aws:cdk:cloudformation:props":{"tags":[{"key":"Name","value":"academia-shared-vpc"}],"privateDnsEnabled":true,"securityGroupIds":[{"Fn::GetAtt":["SharedVpcSecretsManagerEndpointSecurityGroup0AA9D055","GroupId"]}],"serviceName":"com.amazonaws.us-east-1.secretsmanager","subnetIds":[{"Ref":"SharedVpcIsolatedSubnet1Subnet2FB46B24"},{"Ref":"SharedVpcIsolatedSubnet2Subnet96BA40FA"}],"vpcEndpointType":"Interface","vpcId":{"Ref":"SharedVpc96F0F614"}}}}}}}},"DbSecurityGroup":{"id":"DbSecurityGroup","path":"AcademiaSharedDatabase/DbSecurityGroup","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaSharedDatabase/DbSecurityGroup/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Academia RDS PostgreSQL access security group","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Ref":"SharedVpc96F0F614"}}}}}},"DbSecret":{"id":"DbSecret","path":"AcademiaSharedDatabase/DbSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaSharedDatabase/DbSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Academia database credentials for icitysystems RDS instance","generateSecretString":{"secretStringTemplate":"{\"username\":\"academia_admin\",\"host\":\"icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com\",\"port\":5432,\"dbname\":\"academia\",\"engine\":\"postgres\"}","generateStringKey":"password","excludePunctuation":true,"passwordLength":32},"name":"academia/shared/database/credentials"}}}}},"VpcId":{"id":"VpcId","path":"AcademiaSharedDatabase/VpcId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DbEndpoint":{"id":"DbEndpoint","path":"AcademiaSharedDatabase/DbEndpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DbPort":{"id":"DbPort","path":"AcademiaSharedDatabase/DbPort","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DbSecretArn":{"id":"DbSecretArn","path":"AcademiaSharedDatabase/DbSecretArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DbSecurityGroupId":{"id":"DbSecurityGroupId","path":"AcademiaSharedDatabase/DbSecurityGroupId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"RdsSpecifications":{"id":"RdsSpecifications","path":"AcademiaSharedDatabase/RdsSpecifications","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaSharedDatabase/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaSharedDatabase/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"Exports":{"id":"Exports","path":"AcademiaSharedDatabase/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Output{\"Fn::GetAtt\":[\"DbSecurityGroupE9D701AD\",\"GroupId\"]}":{"id":"Output{\"Fn::GetAtt\":[\"DbSecurityGroupE9D701AD\",\"GroupId\"]}","path":"AcademiaSharedDatabase/Exports/Output{\"Fn::GetAtt\":[\"DbSecurityGroupE9D701AD\",\"GroupId\"]}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"Output{\"Ref\":\"SharedVpc96F0F614\"}":{"id":"Output{\"Ref\":\"SharedVpc96F0F614\"}","path":"AcademiaSharedDatabase/Exports/Output{\"Ref\":\"SharedVpc96F0F614\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"Output{\"Ref\":\"DbSecret685A0FA5\"}":{"id":"Output{\"Ref\":\"DbSecret685A0FA5\"}","path":"AcademiaSharedDatabase/Exports/Output{\"Ref\":\"DbSecret685A0FA5\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"Output{\"Ref\":\"SharedVpcIsolatedSubnet1Subnet2FB46B24\"}":{"id":"Output{\"Ref\":\"SharedVpcIsolatedSubnet1Subnet2FB46B24\"}","path":"AcademiaSharedDatabase/Exports/Output{\"Ref\":\"SharedVpcIsolatedSubnet1Subnet2FB46B24\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"Output{\"Ref\":\"SharedVpcIsolatedSubnet2Subnet96BA40FA\"}":{"id":"Output{\"Ref\":\"SharedVpcIsolatedSubnet2Subnet96BA40FA\"}","path":"AcademiaSharedDatabase/Exports/Output{\"Ref\":\"SharedVpcIsolatedSubnet2Subnet96BA40FA\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaSharedDatabase/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaSharedDatabase/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaSes":{"id":"AcademiaSes","path":"AcademiaSes","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"EmailBucket":{"id":"EmailBucket","path":"AcademiaSes/EmailBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaSes/EmailBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-emails-771643347382","lifecycleConfiguration":{"rules":[{"expirationInDays":90,"status":"Enabled"}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true}}}},"Policy":{"id":"Policy","path":"AcademiaSes/EmailBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaSes/EmailBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"EmailBucket843A740F"},"policyDocument":{"Statement":[{"Action":"s3:PutObject","Condition":{"StringEquals":{"aws:SourceAccount":"771643347382"}},"Effect":"Allow","Principal":{"Service":"ses.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["EmailBucket843A740F","Arn"]},"/*"]]}},{"Action":"s3:PutObject","Condition":{"StringEquals":{"aws:SourceAccount":{"Ref":"AWS::AccountId"}}},"Effect":"Allow","Principal":{"Service":"ses.amazonaws.com"},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["EmailBucket843A740F","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"EmailForwarder":{"id":"EmailForwarder","path":"AcademiaSes/EmailForwarder","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.233.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AcademiaSes/EmailForwarder/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AcademiaSes/EmailForwarder/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaSes/EmailForwarder/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AcademiaSes/EmailForwarder/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaSes/EmailForwarder/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["EmailBucket843A740F","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["EmailBucket843A740F","Arn"]},"/*"]]}]},{"Action":["ses:SendRawEmail","ses:SendEmail"],"Effect":"Allow","Resource":"*"}],"Version":"2012-10-17"},"policyName":"EmailForwarderServiceRoleDefaultPolicyD3A7F3A7","roles":[{"Ref":"EmailForwarderServiceRole93812A13"}]}}}}}}},"Resource":{"id":"Resource","path":"AcademiaSes/EmailForwarder/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\nconst { SESClient, SendRawEmailCommand } = require('@aws-sdk/client-ses');\nconst { S3Client, GetObjectCommand } = require('@aws-sdk/client-s3');\n\nconst ses = new SESClient({});\nconst s3 = new S3Client({});\n\nexports.handler = async (event) => {\n  console.log('Email forwarder triggered:', JSON.stringify(event, null, 2));\n\n  for (const record of event.Records) {\n    const sesNotification = record.ses;\n    const messageId = sesNotification.mail.messageId;\n    const bucket = process.env.EMAIL_BUCKET;\n\n    try {\n      // Get the email from S3\n      const s3Response = await s3.send(new GetObjectCommand({\n        Bucket: bucket,\n        Key: messageId,\n      }));\n\n      // Read the email content\n      const chunks = [];\n      for await (const chunk of s3Response.Body) {\n        chunks.push(chunk);\n      }\n      let emailContent = Buffer.concat(chunks).toString('utf-8');\n\n      // Modify headers for forwarding\n      const originalFrom = sesNotification.mail.commonHeaders.from[0];\n      const originalSubject = sesNotification.mail.commonHeaders.subject || '(no subject)';\n\n      // Replace the From header to comply with SES policies\n      // Keep original sender info in the subject\n      emailContent = emailContent.replace(\n        /^From: .*/m,\n        `From: \"Academia Forwarded\" <${process.env.FROM_EMAIL}>`\n      );\n\n      // Add Reply-To header with original sender\n      if (!emailContent.match(/^Reply-To:/m)) {\n        emailContent = emailContent.replace(\n          /^From: /m,\n          `Reply-To: ${originalFrom}\\nFrom: `\n        );\n      }\n\n      // Modify subject to indicate forwarding\n      emailContent = emailContent.replace(\n        /^Subject: .*/m,\n        `Subject: [Fwd: Academia] ${originalSubject}`\n      );\n\n      // Replace the To header\n      emailContent = emailContent.replace(\n        /^To: .*/m,\n        `To: ${process.env.FORWARD_TO}`\n      );\n\n      // Send the forwarded email\n      await ses.send(new SendRawEmailCommand({\n        RawMessage: { Data: Buffer.from(emailContent) },\n        Destinations: [process.env.FORWARD_TO],\n        Source: process.env.FROM_EMAIL,\n      }));\n\n      console.log(`Email ${messageId} forwarded successfully to ${process.env.FORWARD_TO}`);\n    } catch (error) {\n      console.error(`Failed to forward email ${messageId}:`, error);\n      throw error;\n    }\n  }\n\n  return { status: 'success' };\n};\n\t\t\t"},"environment":{"variables":{"FORWARD_TO":"icitysystems@gmail.com","FROM_EMAIL":"academia@icitysystems.org","EMAIL_BUCKET":{"Ref":"EmailBucket843A740F"}}},"functionName":"academia-email-forwarder","handler":"index.handler","memorySize":256,"role":{"Fn::GetAtt":["EmailForwarderServiceRole93812A13","Arn"]},"runtime":"nodejs20.x","timeout":30}}},"SESInvoke":{"id":"SESInvoke","path":"AcademiaSes/EmailForwarder/SESInvoke","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["EmailForwarder4C52F0F4","Arn"]},"principal":"ses.amazonaws.com","sourceAccount":"771643347382"}}},"AllowSes":{"id":"AllowSes","path":"AcademiaSes/EmailForwarder/AllowSes","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["EmailForwarder4C52F0F4","Arn"]},"principal":"ses.amazonaws.com","sourceAccount":{"Ref":"AWS::AccountId"}}}}}},"EmailRuleSet":{"id":"EmailRuleSet","path":"AcademiaSes/EmailRuleSet","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ReceiptRuleSet","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaSes/EmailRuleSet/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnReceiptRuleSet","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ReceiptRuleSet","aws:cdk:cloudformation:props":{"ruleSetName":"academia-email-rules"}}}}},"AcademiaEmailRule":{"id":"AcademiaEmailRule","path":"AcademiaSes/AcademiaEmailRule","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.ReceiptRule","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaSes/AcademiaEmailRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ses.CfnReceiptRule","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SES::ReceiptRule","aws:cdk:cloudformation:props":{"rule":{"actions":[{"s3Action":{"bucketName":{"Ref":"EmailBucket843A740F"}}},{"lambdaAction":{"functionArn":{"Fn::GetAtt":["EmailForwarder4C52F0F4","Arn"]},"invocationType":"Event"}}],"enabled":true,"name":"academia-forward-rule","recipients":["academia@icitysystems.org"],"scanEnabled":true},"ruleSetName":{"Ref":"EmailRuleSetD2B2D9EA"}}}}}},"EmailIdentityArn":{"id":"EmailIdentityArn","path":"AcademiaSes/EmailIdentityArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"EmailBucketName":{"id":"EmailBucketName","path":"AcademiaSes/EmailBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"ForwarderFunctionArn":{"id":"ForwarderFunctionArn","path":"AcademiaSes/ForwarderFunctionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DnsSetupInstructions":{"id":"DnsSetupInstructions","path":"AcademiaSes/DnsSetupInstructions","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaSes/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaSes/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaSes/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaSes/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaBackend-Dev1":{"id":"AcademiaBackend-Dev1","path":"AcademiaBackend-Dev1","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"ImportedDbSG":{"id":"ImportedDbSG","path":"AcademiaBackend-Dev1/ImportedDbSG","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]},"children":{"from AcademiaBackendDev1LambdaSG7A0706EB:5432":{"id":"from AcademiaBackendDev1LambdaSG7A0706EB:5432","path":"AcademiaBackend-Dev1/ImportedDbSG/from AcademiaBackendDev1LambdaSG7A0706EB:5432","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Allow Lambda dev1 to RDS","fromPort":5432,"groupId":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputFnGetAttDbSecurityGroupE9D701ADGroupId7A7C114A"},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["LambdaSG9DBFCFB7","GroupId"]},"toPort":5432}}}}},"LambdaSG":{"id":"LambdaSG","path":"AcademiaBackend-Dev1/LambdaSG","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/LambdaSG/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Academia Lambda SG - dev1","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpc96F0F6140AE947C7"}}}}}},"AssetsBucket":{"id":"AssetsBucket","path":"AcademiaBackend-Dev1/AssetsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AssetsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-assets-dev1-771643347382","corsConfiguration":{"corsRules":[{"maxAge":3600,"allowedHeaders":["*"],"allowedMethods":["GET","PUT","POST","DELETE"],"allowedOrigins":["https://dev1.academia-example.com","https://api.dev1.academia-example.com","http://localhost:3000"]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}],"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"AcademiaBackend-Dev1/AssetsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AssetsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"AssetsBucket5CB76180"},"policyDocument":{"Statement":[{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"AcademiaBackend-Dev1/AssetsBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.233.0","metadata":[]},"children":{"Default":{"id":"Default","path":"AcademiaBackend-Dev1/AssetsBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"AcademiaBackend-Dev1/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.233.0"},"children":{"Staging":{"id":"Staging","path":"AcademiaBackend-Dev1/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.233.0"}},"Role":{"id":"Role","path":"AcademiaBackend-Dev1/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}},"Handler":{"id":"Handler","path":"AcademiaBackend-Dev1/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"JwtSecret":{"id":"JwtSecret","path":"AcademiaBackend-Dev1/JwtSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/JwtSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Academia JWT secret - dev1","generateSecretString":{"passwordLength":64,"excludePunctuation":true},"name":"academia/dev1/jwt-secret"}}}}},"StripeSecret":{"id":"StripeSecret","path":"AcademiaBackend-Dev1/StripeSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/StripeSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Stripe API keys - dev1","name":"academia/dev1/stripe-secret","secretString":"{\"secretKey\":\"sk_test_placeholder\",\"webhookSecret\":\"whsec_placeholder\"}"}}}}},"ImportedDbSecret":{"id":"ImportedDbSecret","path":"AcademiaBackend-Dev1/ImportedDbSecret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"BackendFunction":{"id":"BackendFunction","path":"AcademiaBackend-Dev1/BackendFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.233.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AcademiaBackend-Dev1/BackendFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AcademiaBackend-Dev1/BackendFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/BackendFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AcademiaBackend-Dev1/BackendFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/BackendFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefDbSecret685A0FA57881E1C6"}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"JwtSecretB8834B39"}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"StripeSecret80A38A68"}},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"BackendFunctionServiceRoleDefaultPolicyA83BBE0A","roles":[{"Ref":"BackendFunctionServiceRoleCA938F8D"}]}}}}}}},"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/BackendFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\n\t\t\t\texports.handler = async (event) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tstatusCode: 200,\n\t\t\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\t\t\tbody: JSON.stringify({ \n\t\t\t\t\t\t\tmessage: 'Academia Backend - Deploy code via CI/CD',\n\t\t\t\t\t\t\tenvironment: 'dev1',\n\t\t\t\t\t\t\tdatabase: 'academia',\n\t\t\t\t\t\t\ttimestamp: new Date().toISOString()\n\t\t\t\t\t\t})\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t"},"environment":{"variables":{"NODE_ENV":"development","ENVIRONMENT":"dev1","FRONTEND_URL":"https://dev1.academia-example.com","CORS_ORIGINS":"https://dev1.academia-example.com,http://localhost:3000","DB_SECRET_ARN":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefDbSecret685A0FA57881E1C6"},"DB_HOST":"icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com","DB_PORT":"5432","DB_NAME":"academia","DATABASE_URL":"postgresql://${DB_USER}:${DB_PASS}@icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com:5432/academia","STORAGE_PROVIDER":"s3","AWS_S3_BUCKET":{"Ref":"AssetsBucket5CB76180"},"AWS_S3_REGION":"us-east-1","JWT_SECRET_ARN":{"Ref":"JwtSecretB8834B39"},"STRIPE_SECRET_ARN":{"Ref":"StripeSecret80A38A68"}}},"functionName":"academia-backend-dev1","handler":"dist/lambda.handler","memorySize":512,"role":{"Fn::GetAtt":["BackendFunctionServiceRoleCA938F8D","Arn"]},"runtime":"nodejs20.x","timeout":30,"vpcConfig":{"subnetIds":[{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpcIsolatedSubnet1Subnet2FB46B240A7F37F7"},{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpcIsolatedSubnet2Subnet96BA40FA7DBD9B35"}],"securityGroupIds":[{"Fn::GetAtt":["LambdaSG9DBFCFB7","GroupId"]}]}}}}}},"AcademiaApi":{"id":"AcademiaApi","path":"AcademiaBackend-Dev1/AcademiaApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AcademiaApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"Academia API - dev1","name":"academia-api-dev1"}}},"CloudWatchRole":{"id":"CloudWatchRole","path":"AcademiaBackend-Dev1/AcademiaApi/CloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportCloudWatchRole":{"id":"ImportCloudWatchRole","path":"AcademiaBackend-Dev1/AcademiaApi/CloudWatchRole/ImportCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AcademiaApi/CloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}]}}}}},"Account":{"id":"Account","path":"AcademiaBackend-Dev1/AcademiaApi/Account","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["AcademiaApiCloudWatchRole70B1E378","Arn"]}}}},"Deployment":{"id":"Deployment","path":"AcademiaBackend-Dev1/AcademiaApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AcademiaApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"Academia API - dev1","restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"DeploymentStage.dev1":{"id":"DeploymentStage.dev1","path":"AcademiaBackend-Dev1/AcademiaApi/DeploymentStage.dev1","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AcademiaApi/DeploymentStage.dev1/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"AcademiaApiDeployment07DDCC0Ff11768d4b255ca9464e4924a6b49a3d4"},"methodSettings":[{"httpMethod":"*","resourcePath":"/*","dataTraceEnabled":false,"throttlingBurstLimit":50,"throttlingRateLimit":100}],"restApiId":{"Ref":"AcademiaApiEB0FBB35"},"stageName":"dev1"}}}}},"Endpoint":{"id":"Endpoint","path":"AcademiaBackend-Dev1/AcademiaApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"Default":{"id":"Default","path":"AcademiaBackend-Dev1/AcademiaApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.233.0","metadata":[]},"children":{"OPTIONS":{"id":"OPTIONS","path":"AcademiaBackend-Dev1/AcademiaApi/Default/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AcademiaApi/Default/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'https://dev1.academia-example.com'","method.response.header.Vary":"'Origin'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"responseTemplates":{"application/json":"#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"http://localhost:3000\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Vary":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"resourceId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"{proxy+}":{"id":"{proxy+}","path":"AcademiaBackend-Dev1/AcademiaApi/Default/{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ProxyResource","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AcademiaApi/Default/{proxy+}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"pathPart":"{proxy+}","restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}},"OPTIONS":{"id":"OPTIONS","path":"AcademiaBackend-Dev1/AcademiaApi/Default/{proxy+}/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AcademiaApi/Default/{proxy+}/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'https://dev1.academia-example.com'","method.response.header.Vary":"'Origin'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"responseTemplates":{"application/json":"#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"http://localhost:3000\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Vary":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"resourceId":{"Ref":"AcademiaApiproxyCA83FD4D"},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"ANY":{"id":"ANY","path":"AcademiaBackend-Dev1/AcademiaApi/Default/{proxy+}/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"ApiPermission.AcademiaBackendDev1AcademiaApi1CF8C36A.ANY..{proxy+}":{"id":"ApiPermission.AcademiaBackendDev1AcademiaApi1CF8C36A.ANY..{proxy+}","path":"AcademiaBackend-Dev1/AcademiaApi/Default/{proxy+}/ANY/ApiPermission.AcademiaBackendDev1AcademiaApi1CF8C36A.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackendFunction63314140","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:771643347382:",{"Ref":"AcademiaApiEB0FBB35"},"/",{"Ref":"AcademiaApiDeploymentStagedev182E23E1C"},"/*/*"]]}}}},"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AcademiaApi/Default/{proxy+}/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["BackendFunction63314140","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"AcademiaApiproxyCA83FD4D"},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}}}},"ANY":{"id":"ANY","path":"AcademiaBackend-Dev1/AcademiaApi/Default/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev1/AcademiaApi/Default/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"MOCK"},"resourceId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}}}}}},"ApiUrl":{"id":"ApiUrl","path":"AcademiaBackend-Dev1/ApiUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"LambdaFunctionName":{"id":"LambdaFunctionName","path":"AcademiaBackend-Dev1/LambdaFunctionName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"AssetsBucketName":{"id":"AssetsBucketName","path":"AcademiaBackend-Dev1/AssetsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DatabaseName":{"id":"DatabaseName","path":"AcademiaBackend-Dev1/DatabaseName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaBackend-Dev1/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaBackend-Dev1/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"Exports":{"id":"Exports","path":"AcademiaBackend-Dev1/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Output{\"Ref\":\"AcademiaApiEB0FBB35\"}":{"id":"Output{\"Ref\":\"AcademiaApiEB0FBB35\"}","path":"AcademiaBackend-Dev1/Exports/Output{\"Ref\":\"AcademiaApiEB0FBB35\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaBackend-Dev1/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaBackend-Dev1/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaFrontend-Dev1":{"id":"AcademiaFrontend-Dev1","path":"AcademiaFrontend-Dev1","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"FrontendBucket":{"id":"FrontendBucket","path":"AcademiaFrontend-Dev1/FrontendBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Dev1/FrontendBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-frontend-dev1-771643347382","publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"AcademiaFrontend-Dev1/FrontendBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Dev1/FrontendBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"FrontendBucketEFE2E19C"},"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}]},{"Action":"s3:GetObject","Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"OAI":{"id":"OAI","path":"AcademiaFrontend-Dev1/OAI","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.OriginAccessIdentity","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Dev1/OAI/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnCloudFrontOriginAccessIdentity","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::CloudFrontOriginAccessIdentity","aws:cdk:cloudformation:props":{"cloudFrontOriginAccessIdentityConfig":{"comment":"Academia Frontend OAI"}}}}}},"Distribution":{"id":"Distribution","path":"AcademiaFrontend-Dev1/Distribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.233.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"AcademiaFrontend-Dev1/Distribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Origin2":{"id":"Origin2","path":"AcademiaFrontend-Dev1/Distribution/Origin2","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Origin3":{"id":"Origin3","path":"AcademiaFrontend-Dev1/Distribution/Origin3","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Resource":{"id":"Resource","path":"AcademiaFrontend-Dev1/Distribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::GetAtt":["FrontendBucketEFE2E19C","RegionalDomainName"]},"id":"AcademiaFrontendDev1DistributionOrigin1DE6F8B63","s3OriginConfig":{"originAccessIdentity":{"Fn::Join":["",["origin-access-identity/cloudfront/",{"Ref":"OAIE1EFC67F"}]]}}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"AcademiaBackend-Dev1:ExportsOutputRefAcademiaApiEB0FBB3526983528"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"}]]},"id":"AcademiaFrontendDev1DistributionOrigin27A869732","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"AcademiaBackend-Dev1:ExportsOutputRefAcademiaApiEB0FBB3526983528"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"}]]},"id":"AcademiaFrontendDev1DistributionOrigin3AF41BA29","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"AcademiaFrontendDev1DistributionOrigin1DE6F8B63","allowedMethods":["GET","HEAD","OPTIONS"],"cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6","compress":true,"viewerProtocolPolicy":"redirect-to-https"},"cacheBehaviors":[{"pathPattern":"/api/*","targetOriginId":"AcademiaFrontendDev1DistributionOrigin27A869732","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac","viewerProtocolPolicy":"https-only"},{"pathPattern":"/graphql","targetOriginId":"AcademiaFrontendDev1DistributionOrigin3AF41BA29","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac","viewerProtocolPolicy":"https-only"}],"customErrorResponses":[{"errorCachingMinTtl":300,"errorCode":403,"responseCode":200,"responsePagePath":"/index.html"},{"errorCachingMinTtl":300,"errorCode":404,"responseCode":200,"responsePagePath":"/index.html"}],"defaultRootObject":"index.html","httpVersion":"http2","ipv6Enabled":true,"priceClass":"PriceClass_100"}}}}}},"FrontendUrl":{"id":"FrontendUrl","path":"AcademiaFrontend-Dev1/FrontendUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DistributionId":{"id":"DistributionId","path":"AcademiaFrontend-Dev1/DistributionId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DistributionDomainName":{"id":"DistributionDomainName","path":"AcademiaFrontend-Dev1/DistributionDomainName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"FrontendBucketName":{"id":"FrontendBucketName","path":"AcademiaFrontend-Dev1/FrontendBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaFrontend-Dev1/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaFrontend-Dev1/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaFrontend-Dev1/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaFrontend-Dev1/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaBackend-Dev2":{"id":"AcademiaBackend-Dev2","path":"AcademiaBackend-Dev2","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"ImportedDbSG":{"id":"ImportedDbSG","path":"AcademiaBackend-Dev2/ImportedDbSG","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]},"children":{"from AcademiaBackendDev2LambdaSGED945779:5432":{"id":"from AcademiaBackendDev2LambdaSGED945779:5432","path":"AcademiaBackend-Dev2/ImportedDbSG/from AcademiaBackendDev2LambdaSGED945779:5432","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Allow Lambda dev2 to RDS","fromPort":5432,"groupId":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputFnGetAttDbSecurityGroupE9D701ADGroupId7A7C114A"},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["LambdaSG9DBFCFB7","GroupId"]},"toPort":5432}}}}},"LambdaSG":{"id":"LambdaSG","path":"AcademiaBackend-Dev2/LambdaSG","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/LambdaSG/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Academia Lambda SG - dev2","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpc96F0F6140AE947C7"}}}}}},"AssetsBucket":{"id":"AssetsBucket","path":"AcademiaBackend-Dev2/AssetsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AssetsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-assets-dev2-771643347382","corsConfiguration":{"corsRules":[{"maxAge":3600,"allowedHeaders":["*"],"allowedMethods":["GET","PUT","POST","DELETE"],"allowedOrigins":["https://dev2.academia-example.com","https://api.dev2.academia-example.com","http://localhost:3000"]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}],"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"AcademiaBackend-Dev2/AssetsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AssetsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"AssetsBucket5CB76180"},"policyDocument":{"Statement":[{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"AcademiaBackend-Dev2/AssetsBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.233.0","metadata":[]},"children":{"Default":{"id":"Default","path":"AcademiaBackend-Dev2/AssetsBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"AcademiaBackend-Dev2/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.233.0"},"children":{"Staging":{"id":"Staging","path":"AcademiaBackend-Dev2/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.233.0"}},"Role":{"id":"Role","path":"AcademiaBackend-Dev2/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}},"Handler":{"id":"Handler","path":"AcademiaBackend-Dev2/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"JwtSecret":{"id":"JwtSecret","path":"AcademiaBackend-Dev2/JwtSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/JwtSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Academia JWT secret - dev2","generateSecretString":{"passwordLength":64,"excludePunctuation":true},"name":"academia/dev2/jwt-secret"}}}}},"StripeSecret":{"id":"StripeSecret","path":"AcademiaBackend-Dev2/StripeSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/StripeSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Stripe API keys - dev2","name":"academia/dev2/stripe-secret","secretString":"{\"secretKey\":\"sk_test_placeholder\",\"webhookSecret\":\"whsec_placeholder\"}"}}}}},"ImportedDbSecret":{"id":"ImportedDbSecret","path":"AcademiaBackend-Dev2/ImportedDbSecret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"BackendFunction":{"id":"BackendFunction","path":"AcademiaBackend-Dev2/BackendFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.233.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AcademiaBackend-Dev2/BackendFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AcademiaBackend-Dev2/BackendFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/BackendFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AcademiaBackend-Dev2/BackendFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/BackendFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefDbSecret685A0FA57881E1C6"}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"JwtSecretB8834B39"}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"StripeSecret80A38A68"}},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"BackendFunctionServiceRoleDefaultPolicyA83BBE0A","roles":[{"Ref":"BackendFunctionServiceRoleCA938F8D"}]}}}}}}},"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/BackendFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\n\t\t\t\texports.handler = async (event) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tstatusCode: 200,\n\t\t\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\t\t\tbody: JSON.stringify({ \n\t\t\t\t\t\t\tmessage: 'Academia Backend - Deploy code via CI/CD',\n\t\t\t\t\t\t\tenvironment: 'dev2',\n\t\t\t\t\t\t\tdatabase: 'academia',\n\t\t\t\t\t\t\ttimestamp: new Date().toISOString()\n\t\t\t\t\t\t})\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t"},"environment":{"variables":{"NODE_ENV":"development","ENVIRONMENT":"dev2","FRONTEND_URL":"https://dev2.academia-example.com","CORS_ORIGINS":"https://dev2.academia-example.com,http://localhost:3000","DB_SECRET_ARN":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefDbSecret685A0FA57881E1C6"},"DB_HOST":"icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com","DB_PORT":"5432","DB_NAME":"academia","DATABASE_URL":"postgresql://${DB_USER}:${DB_PASS}@icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com:5432/academia","STORAGE_PROVIDER":"s3","AWS_S3_BUCKET":{"Ref":"AssetsBucket5CB76180"},"AWS_S3_REGION":"us-east-1","JWT_SECRET_ARN":{"Ref":"JwtSecretB8834B39"},"STRIPE_SECRET_ARN":{"Ref":"StripeSecret80A38A68"}}},"functionName":"academia-backend-dev2","handler":"dist/lambda.handler","memorySize":512,"role":{"Fn::GetAtt":["BackendFunctionServiceRoleCA938F8D","Arn"]},"runtime":"nodejs20.x","timeout":30,"vpcConfig":{"subnetIds":[{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpcIsolatedSubnet1Subnet2FB46B240A7F37F7"},{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpcIsolatedSubnet2Subnet96BA40FA7DBD9B35"}],"securityGroupIds":[{"Fn::GetAtt":["LambdaSG9DBFCFB7","GroupId"]}]}}}}}},"AcademiaApi":{"id":"AcademiaApi","path":"AcademiaBackend-Dev2/AcademiaApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AcademiaApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"Academia API - dev2","name":"academia-api-dev2"}}},"CloudWatchRole":{"id":"CloudWatchRole","path":"AcademiaBackend-Dev2/AcademiaApi/CloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportCloudWatchRole":{"id":"ImportCloudWatchRole","path":"AcademiaBackend-Dev2/AcademiaApi/CloudWatchRole/ImportCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AcademiaApi/CloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}]}}}}},"Account":{"id":"Account","path":"AcademiaBackend-Dev2/AcademiaApi/Account","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["AcademiaApiCloudWatchRole70B1E378","Arn"]}}}},"Deployment":{"id":"Deployment","path":"AcademiaBackend-Dev2/AcademiaApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AcademiaApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"Academia API - dev2","restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"DeploymentStage.dev2":{"id":"DeploymentStage.dev2","path":"AcademiaBackend-Dev2/AcademiaApi/DeploymentStage.dev2","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AcademiaApi/DeploymentStage.dev2/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"AcademiaApiDeployment07DDCC0Fa1c095a1eff4a3fd9d8a592ff3ca6f6c"},"methodSettings":[{"httpMethod":"*","resourcePath":"/*","dataTraceEnabled":false,"throttlingBurstLimit":50,"throttlingRateLimit":100}],"restApiId":{"Ref":"AcademiaApiEB0FBB35"},"stageName":"dev2"}}}}},"Endpoint":{"id":"Endpoint","path":"AcademiaBackend-Dev2/AcademiaApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"Default":{"id":"Default","path":"AcademiaBackend-Dev2/AcademiaApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.233.0","metadata":[]},"children":{"OPTIONS":{"id":"OPTIONS","path":"AcademiaBackend-Dev2/AcademiaApi/Default/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AcademiaApi/Default/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'https://dev2.academia-example.com'","method.response.header.Vary":"'Origin'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"responseTemplates":{"application/json":"#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"http://localhost:3000\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Vary":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"resourceId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"{proxy+}":{"id":"{proxy+}","path":"AcademiaBackend-Dev2/AcademiaApi/Default/{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ProxyResource","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AcademiaApi/Default/{proxy+}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"pathPart":"{proxy+}","restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}},"OPTIONS":{"id":"OPTIONS","path":"AcademiaBackend-Dev2/AcademiaApi/Default/{proxy+}/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AcademiaApi/Default/{proxy+}/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'https://dev2.academia-example.com'","method.response.header.Vary":"'Origin'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"responseTemplates":{"application/json":"#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"http://localhost:3000\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Vary":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"resourceId":{"Ref":"AcademiaApiproxyCA83FD4D"},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"ANY":{"id":"ANY","path":"AcademiaBackend-Dev2/AcademiaApi/Default/{proxy+}/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"ApiPermission.AcademiaBackendDev2AcademiaApi736EA8BB.ANY..{proxy+}":{"id":"ApiPermission.AcademiaBackendDev2AcademiaApi736EA8BB.ANY..{proxy+}","path":"AcademiaBackend-Dev2/AcademiaApi/Default/{proxy+}/ANY/ApiPermission.AcademiaBackendDev2AcademiaApi736EA8BB.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackendFunction63314140","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:771643347382:",{"Ref":"AcademiaApiEB0FBB35"},"/",{"Ref":"AcademiaApiDeploymentStagedev25B68189B"},"/*/*"]]}}}},"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AcademiaApi/Default/{proxy+}/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["BackendFunction63314140","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"AcademiaApiproxyCA83FD4D"},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}}}},"ANY":{"id":"ANY","path":"AcademiaBackend-Dev2/AcademiaApi/Default/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Dev2/AcademiaApi/Default/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"MOCK"},"resourceId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}}}}}},"ApiUrl":{"id":"ApiUrl","path":"AcademiaBackend-Dev2/ApiUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"LambdaFunctionName":{"id":"LambdaFunctionName","path":"AcademiaBackend-Dev2/LambdaFunctionName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"AssetsBucketName":{"id":"AssetsBucketName","path":"AcademiaBackend-Dev2/AssetsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DatabaseName":{"id":"DatabaseName","path":"AcademiaBackend-Dev2/DatabaseName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaBackend-Dev2/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaBackend-Dev2/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"Exports":{"id":"Exports","path":"AcademiaBackend-Dev2/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Output{\"Ref\":\"AcademiaApiEB0FBB35\"}":{"id":"Output{\"Ref\":\"AcademiaApiEB0FBB35\"}","path":"AcademiaBackend-Dev2/Exports/Output{\"Ref\":\"AcademiaApiEB0FBB35\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaBackend-Dev2/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaBackend-Dev2/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaFrontend-Dev2":{"id":"AcademiaFrontend-Dev2","path":"AcademiaFrontend-Dev2","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"FrontendBucket":{"id":"FrontendBucket","path":"AcademiaFrontend-Dev2/FrontendBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Dev2/FrontendBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-frontend-dev2-771643347382","publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"AcademiaFrontend-Dev2/FrontendBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Dev2/FrontendBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"FrontendBucketEFE2E19C"},"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}]},{"Action":"s3:GetObject","Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"OAI":{"id":"OAI","path":"AcademiaFrontend-Dev2/OAI","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.OriginAccessIdentity","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Dev2/OAI/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnCloudFrontOriginAccessIdentity","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::CloudFrontOriginAccessIdentity","aws:cdk:cloudformation:props":{"cloudFrontOriginAccessIdentityConfig":{"comment":"Academia Frontend OAI"}}}}}},"Distribution":{"id":"Distribution","path":"AcademiaFrontend-Dev2/Distribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.233.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"AcademiaFrontend-Dev2/Distribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Origin2":{"id":"Origin2","path":"AcademiaFrontend-Dev2/Distribution/Origin2","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Origin3":{"id":"Origin3","path":"AcademiaFrontend-Dev2/Distribution/Origin3","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Resource":{"id":"Resource","path":"AcademiaFrontend-Dev2/Distribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::GetAtt":["FrontendBucketEFE2E19C","RegionalDomainName"]},"id":"AcademiaFrontendDev2DistributionOrigin185DF53C6","s3OriginConfig":{"originAccessIdentity":{"Fn::Join":["",["origin-access-identity/cloudfront/",{"Ref":"OAIE1EFC67F"}]]}}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"AcademiaBackend-Dev2:ExportsOutputRefAcademiaApiEB0FBB3526983528"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"}]]},"id":"AcademiaFrontendDev2DistributionOrigin234911EE0","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"AcademiaBackend-Dev2:ExportsOutputRefAcademiaApiEB0FBB3526983528"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"}]]},"id":"AcademiaFrontendDev2DistributionOrigin32FFB1D01","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"AcademiaFrontendDev2DistributionOrigin185DF53C6","allowedMethods":["GET","HEAD","OPTIONS"],"cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6","compress":true,"viewerProtocolPolicy":"redirect-to-https"},"cacheBehaviors":[{"pathPattern":"/api/*","targetOriginId":"AcademiaFrontendDev2DistributionOrigin234911EE0","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac","viewerProtocolPolicy":"https-only"},{"pathPattern":"/graphql","targetOriginId":"AcademiaFrontendDev2DistributionOrigin32FFB1D01","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac","viewerProtocolPolicy":"https-only"}],"customErrorResponses":[{"errorCachingMinTtl":300,"errorCode":403,"responseCode":200,"responsePagePath":"/index.html"},{"errorCachingMinTtl":300,"errorCode":404,"responseCode":200,"responsePagePath":"/index.html"}],"defaultRootObject":"index.html","httpVersion":"http2","ipv6Enabled":true,"priceClass":"PriceClass_100"}}}}}},"FrontendUrl":{"id":"FrontendUrl","path":"AcademiaFrontend-Dev2/FrontendUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DistributionId":{"id":"DistributionId","path":"AcademiaFrontend-Dev2/DistributionId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DistributionDomainName":{"id":"DistributionDomainName","path":"AcademiaFrontend-Dev2/DistributionDomainName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"FrontendBucketName":{"id":"FrontendBucketName","path":"AcademiaFrontend-Dev2/FrontendBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaFrontend-Dev2/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaFrontend-Dev2/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaFrontend-Dev2/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaFrontend-Dev2/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaBackend-Testing":{"id":"AcademiaBackend-Testing","path":"AcademiaBackend-Testing","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"ImportedDbSG":{"id":"ImportedDbSG","path":"AcademiaBackend-Testing/ImportedDbSG","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]},"children":{"from AcademiaBackendTestingLambdaSG138BB225:5432":{"id":"from AcademiaBackendTestingLambdaSG138BB225:5432","path":"AcademiaBackend-Testing/ImportedDbSG/from AcademiaBackendTestingLambdaSG138BB225:5432","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Allow Lambda testing to RDS","fromPort":5432,"groupId":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputFnGetAttDbSecurityGroupE9D701ADGroupId7A7C114A"},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["LambdaSG9DBFCFB7","GroupId"]},"toPort":5432}}}}},"LambdaSG":{"id":"LambdaSG","path":"AcademiaBackend-Testing/LambdaSG","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/LambdaSG/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Academia Lambda SG - testing","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpc96F0F6140AE947C7"}}}}}},"AssetsBucket":{"id":"AssetsBucket","path":"AcademiaBackend-Testing/AssetsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AssetsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-assets-testing-771643347382","corsConfiguration":{"corsRules":[{"maxAge":3600,"allowedHeaders":["*"],"allowedMethods":["GET","PUT","POST","DELETE"],"allowedOrigins":["https://test.academia-example.com","https://api.test.academia-example.com","http://localhost:3000"]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}],"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"AcademiaBackend-Testing/AssetsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AssetsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"AssetsBucket5CB76180"},"policyDocument":{"Statement":[{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"AcademiaBackend-Testing/AssetsBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.233.0","metadata":[]},"children":{"Default":{"id":"Default","path":"AcademiaBackend-Testing/AssetsBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"AcademiaBackend-Testing/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.233.0"},"children":{"Staging":{"id":"Staging","path":"AcademiaBackend-Testing/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.233.0"}},"Role":{"id":"Role","path":"AcademiaBackend-Testing/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}},"Handler":{"id":"Handler","path":"AcademiaBackend-Testing/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"JwtSecret":{"id":"JwtSecret","path":"AcademiaBackend-Testing/JwtSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/JwtSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Academia JWT secret - testing","generateSecretString":{"passwordLength":64,"excludePunctuation":true},"name":"academia/testing/jwt-secret"}}}}},"StripeSecret":{"id":"StripeSecret","path":"AcademiaBackend-Testing/StripeSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/StripeSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Stripe API keys - testing","name":"academia/testing/stripe-secret","secretString":"{\"secretKey\":\"sk_test_placeholder\",\"webhookSecret\":\"whsec_placeholder\"}"}}}}},"ImportedDbSecret":{"id":"ImportedDbSecret","path":"AcademiaBackend-Testing/ImportedDbSecret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"BackendFunction":{"id":"BackendFunction","path":"AcademiaBackend-Testing/BackendFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.233.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AcademiaBackend-Testing/BackendFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AcademiaBackend-Testing/BackendFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/BackendFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AcademiaBackend-Testing/BackendFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/BackendFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefDbSecret685A0FA57881E1C6"}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"JwtSecretB8834B39"}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"StripeSecret80A38A68"}},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"BackendFunctionServiceRoleDefaultPolicyA83BBE0A","roles":[{"Ref":"BackendFunctionServiceRoleCA938F8D"}]}}}}}}},"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/BackendFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\n\t\t\t\texports.handler = async (event) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tstatusCode: 200,\n\t\t\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\t\t\tbody: JSON.stringify({ \n\t\t\t\t\t\t\tmessage: 'Academia Backend - Deploy code via CI/CD',\n\t\t\t\t\t\t\tenvironment: 'testing',\n\t\t\t\t\t\t\tdatabase: 'academia',\n\t\t\t\t\t\t\ttimestamp: new Date().toISOString()\n\t\t\t\t\t\t})\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t"},"environment":{"variables":{"NODE_ENV":"development","ENVIRONMENT":"testing","FRONTEND_URL":"https://test.academia-example.com","CORS_ORIGINS":"https://test.academia-example.com,http://localhost:3000","DB_SECRET_ARN":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefDbSecret685A0FA57881E1C6"},"DB_HOST":"icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com","DB_PORT":"5432","DB_NAME":"academia","DATABASE_URL":"postgresql://${DB_USER}:${DB_PASS}@icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com:5432/academia","STORAGE_PROVIDER":"s3","AWS_S3_BUCKET":{"Ref":"AssetsBucket5CB76180"},"AWS_S3_REGION":"us-east-1","JWT_SECRET_ARN":{"Ref":"JwtSecretB8834B39"},"STRIPE_SECRET_ARN":{"Ref":"StripeSecret80A38A68"}}},"functionName":"academia-backend-testing","handler":"dist/lambda.handler","memorySize":1024,"role":{"Fn::GetAtt":["BackendFunctionServiceRoleCA938F8D","Arn"]},"runtime":"nodejs20.x","timeout":30,"vpcConfig":{"subnetIds":[{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpcIsolatedSubnet1Subnet2FB46B240A7F37F7"},{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpcIsolatedSubnet2Subnet96BA40FA7DBD9B35"}],"securityGroupIds":[{"Fn::GetAtt":["LambdaSG9DBFCFB7","GroupId"]}]}}}}}},"AcademiaApi":{"id":"AcademiaApi","path":"AcademiaBackend-Testing/AcademiaApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AcademiaApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"Academia API - testing","name":"academia-api-testing"}}},"CloudWatchRole":{"id":"CloudWatchRole","path":"AcademiaBackend-Testing/AcademiaApi/CloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportCloudWatchRole":{"id":"ImportCloudWatchRole","path":"AcademiaBackend-Testing/AcademiaApi/CloudWatchRole/ImportCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AcademiaApi/CloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}]}}}}},"Account":{"id":"Account","path":"AcademiaBackend-Testing/AcademiaApi/Account","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["AcademiaApiCloudWatchRole70B1E378","Arn"]}}}},"Deployment":{"id":"Deployment","path":"AcademiaBackend-Testing/AcademiaApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AcademiaApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"Academia API - testing","restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"DeploymentStage.testing":{"id":"DeploymentStage.testing","path":"AcademiaBackend-Testing/AcademiaApi/DeploymentStage.testing","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AcademiaApi/DeploymentStage.testing/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"AcademiaApiDeployment07DDCC0Fde21a969629c1251f3c646ced4c66559"},"methodSettings":[{"httpMethod":"*","resourcePath":"/*","dataTraceEnabled":false,"throttlingBurstLimit":200,"throttlingRateLimit":500}],"restApiId":{"Ref":"AcademiaApiEB0FBB35"},"stageName":"testing"}}}}},"Endpoint":{"id":"Endpoint","path":"AcademiaBackend-Testing/AcademiaApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"Default":{"id":"Default","path":"AcademiaBackend-Testing/AcademiaApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.233.0","metadata":[]},"children":{"OPTIONS":{"id":"OPTIONS","path":"AcademiaBackend-Testing/AcademiaApi/Default/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AcademiaApi/Default/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'https://test.academia-example.com'","method.response.header.Vary":"'Origin'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"responseTemplates":{"application/json":"#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"http://localhost:3000\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Vary":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"resourceId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"{proxy+}":{"id":"{proxy+}","path":"AcademiaBackend-Testing/AcademiaApi/Default/{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ProxyResource","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AcademiaApi/Default/{proxy+}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"pathPart":"{proxy+}","restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}},"OPTIONS":{"id":"OPTIONS","path":"AcademiaBackend-Testing/AcademiaApi/Default/{proxy+}/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AcademiaApi/Default/{proxy+}/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'https://test.academia-example.com'","method.response.header.Vary":"'Origin'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"responseTemplates":{"application/json":"#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"http://localhost:3000\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Vary":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"resourceId":{"Ref":"AcademiaApiproxyCA83FD4D"},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"ANY":{"id":"ANY","path":"AcademiaBackend-Testing/AcademiaApi/Default/{proxy+}/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"ApiPermission.AcademiaBackendTestingAcademiaApiD9B15E14.ANY..{proxy+}":{"id":"ApiPermission.AcademiaBackendTestingAcademiaApiD9B15E14.ANY..{proxy+}","path":"AcademiaBackend-Testing/AcademiaApi/Default/{proxy+}/ANY/ApiPermission.AcademiaBackendTestingAcademiaApiD9B15E14.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackendFunction63314140","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:771643347382:",{"Ref":"AcademiaApiEB0FBB35"},"/",{"Ref":"AcademiaApiDeploymentStagetesting5C774183"},"/*/*"]]}}}},"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AcademiaApi/Default/{proxy+}/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["BackendFunction63314140","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"AcademiaApiproxyCA83FD4D"},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}}}},"ANY":{"id":"ANY","path":"AcademiaBackend-Testing/AcademiaApi/Default/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Testing/AcademiaApi/Default/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"MOCK"},"resourceId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}}}}}},"ApiUrl":{"id":"ApiUrl","path":"AcademiaBackend-Testing/ApiUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"LambdaFunctionName":{"id":"LambdaFunctionName","path":"AcademiaBackend-Testing/LambdaFunctionName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"AssetsBucketName":{"id":"AssetsBucketName","path":"AcademiaBackend-Testing/AssetsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DatabaseName":{"id":"DatabaseName","path":"AcademiaBackend-Testing/DatabaseName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaBackend-Testing/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaBackend-Testing/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"Exports":{"id":"Exports","path":"AcademiaBackend-Testing/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Output{\"Ref\":\"AcademiaApiEB0FBB35\"}":{"id":"Output{\"Ref\":\"AcademiaApiEB0FBB35\"}","path":"AcademiaBackend-Testing/Exports/Output{\"Ref\":\"AcademiaApiEB0FBB35\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaBackend-Testing/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaBackend-Testing/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaFrontend-Testing":{"id":"AcademiaFrontend-Testing","path":"AcademiaFrontend-Testing","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"FrontendBucket":{"id":"FrontendBucket","path":"AcademiaFrontend-Testing/FrontendBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Testing/FrontendBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-frontend-testing-771643347382","publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"AcademiaFrontend-Testing/FrontendBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Testing/FrontendBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"FrontendBucketEFE2E19C"},"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}]},{"Action":"s3:GetObject","Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"OAI":{"id":"OAI","path":"AcademiaFrontend-Testing/OAI","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.OriginAccessIdentity","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Testing/OAI/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnCloudFrontOriginAccessIdentity","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::CloudFrontOriginAccessIdentity","aws:cdk:cloudformation:props":{"cloudFrontOriginAccessIdentityConfig":{"comment":"Academia Frontend OAI"}}}}}},"Distribution":{"id":"Distribution","path":"AcademiaFrontend-Testing/Distribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.233.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"AcademiaFrontend-Testing/Distribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Origin2":{"id":"Origin2","path":"AcademiaFrontend-Testing/Distribution/Origin2","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Origin3":{"id":"Origin3","path":"AcademiaFrontend-Testing/Distribution/Origin3","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Resource":{"id":"Resource","path":"AcademiaFrontend-Testing/Distribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::GetAtt":["FrontendBucketEFE2E19C","RegionalDomainName"]},"id":"AcademiaFrontendTestingDistributionOrigin1C6B1B580","s3OriginConfig":{"originAccessIdentity":{"Fn::Join":["",["origin-access-identity/cloudfront/",{"Ref":"OAIE1EFC67F"}]]}}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"AcademiaBackend-Testing:ExportsOutputRefAcademiaApiEB0FBB3526983528"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"}]]},"id":"AcademiaFrontendTestingDistributionOrigin2158EF641","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"AcademiaBackend-Testing:ExportsOutputRefAcademiaApiEB0FBB3526983528"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"}]]},"id":"AcademiaFrontendTestingDistributionOrigin35D89ACE7","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"AcademiaFrontendTestingDistributionOrigin1C6B1B580","allowedMethods":["GET","HEAD","OPTIONS"],"cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6","compress":true,"viewerProtocolPolicy":"redirect-to-https"},"cacheBehaviors":[{"pathPattern":"/api/*","targetOriginId":"AcademiaFrontendTestingDistributionOrigin2158EF641","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac","viewerProtocolPolicy":"https-only"},{"pathPattern":"/graphql","targetOriginId":"AcademiaFrontendTestingDistributionOrigin35D89ACE7","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac","viewerProtocolPolicy":"https-only"}],"customErrorResponses":[{"errorCachingMinTtl":300,"errorCode":403,"responseCode":200,"responsePagePath":"/index.html"},{"errorCachingMinTtl":300,"errorCode":404,"responseCode":200,"responsePagePath":"/index.html"}],"defaultRootObject":"index.html","httpVersion":"http2","ipv6Enabled":true,"priceClass":"PriceClass_100"}}}}}},"FrontendUrl":{"id":"FrontendUrl","path":"AcademiaFrontend-Testing/FrontendUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DistributionId":{"id":"DistributionId","path":"AcademiaFrontend-Testing/DistributionId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DistributionDomainName":{"id":"DistributionDomainName","path":"AcademiaFrontend-Testing/DistributionDomainName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"FrontendBucketName":{"id":"FrontendBucketName","path":"AcademiaFrontend-Testing/FrontendBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaFrontend-Testing/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaFrontend-Testing/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaFrontend-Testing/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaFrontend-Testing/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaBackend-Staging":{"id":"AcademiaBackend-Staging","path":"AcademiaBackend-Staging","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"ImportedDbSG":{"id":"ImportedDbSG","path":"AcademiaBackend-Staging/ImportedDbSG","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]},"children":{"from AcademiaBackendStagingLambdaSG30FCC535:5432":{"id":"from AcademiaBackendStagingLambdaSG30FCC535:5432","path":"AcademiaBackend-Staging/ImportedDbSG/from AcademiaBackendStagingLambdaSG30FCC535:5432","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Allow Lambda staging to RDS","fromPort":5432,"groupId":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputFnGetAttDbSecurityGroupE9D701ADGroupId7A7C114A"},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["LambdaSG9DBFCFB7","GroupId"]},"toPort":5432}}}}},"LambdaSG":{"id":"LambdaSG","path":"AcademiaBackend-Staging/LambdaSG","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/LambdaSG/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Academia Lambda SG - staging","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpc96F0F6140AE947C7"}}}}}},"AssetsBucket":{"id":"AssetsBucket","path":"AcademiaBackend-Staging/AssetsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AssetsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-assets-staging-771643347382","corsConfiguration":{"corsRules":[{"maxAge":3600,"allowedHeaders":["*"],"allowedMethods":["GET","PUT","POST","DELETE"],"allowedOrigins":["https://staging.academia-example.com","https://api.staging.academia-example.com","http://localhost:3000"]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}],"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"AcademiaBackend-Staging/AssetsBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AssetsBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"AssetsBucket5CB76180"},"policyDocument":{"Statement":[{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"AcademiaBackend-Staging/AssetsBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.233.0","metadata":[]},"children":{"Default":{"id":"Default","path":"AcademiaBackend-Staging/AssetsBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}}}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"AcademiaBackend-Staging/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.233.0"},"children":{"Staging":{"id":"Staging","path":"AcademiaBackend-Staging/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.233.0"}},"Role":{"id":"Role","path":"AcademiaBackend-Staging/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}},"Handler":{"id":"Handler","path":"AcademiaBackend-Staging/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"JwtSecret":{"id":"JwtSecret","path":"AcademiaBackend-Staging/JwtSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/JwtSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Academia JWT secret - staging","generateSecretString":{"passwordLength":64,"excludePunctuation":true},"name":"academia/staging/jwt-secret"}}}}},"StripeSecret":{"id":"StripeSecret","path":"AcademiaBackend-Staging/StripeSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/StripeSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Stripe API keys - staging","name":"academia/staging/stripe-secret","secretString":"{\"secretKey\":\"sk_test_placeholder\",\"webhookSecret\":\"whsec_placeholder\"}"}}}}},"ImportedDbSecret":{"id":"ImportedDbSecret","path":"AcademiaBackend-Staging/ImportedDbSecret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"BackendFunction":{"id":"BackendFunction","path":"AcademiaBackend-Staging/BackendFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.233.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AcademiaBackend-Staging/BackendFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AcademiaBackend-Staging/BackendFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/BackendFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AcademiaBackend-Staging/BackendFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/BackendFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefDbSecret685A0FA57881E1C6"}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"JwtSecretB8834B39"}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"StripeSecret80A38A68"}},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"BackendFunctionServiceRoleDefaultPolicyA83BBE0A","roles":[{"Ref":"BackendFunctionServiceRoleCA938F8D"}]}}}}}}},"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/BackendFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\n\t\t\t\texports.handler = async (event) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tstatusCode: 200,\n\t\t\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\t\t\tbody: JSON.stringify({ \n\t\t\t\t\t\t\tmessage: 'Academia Backend - Deploy code via CI/CD',\n\t\t\t\t\t\t\tenvironment: 'staging',\n\t\t\t\t\t\t\tdatabase: 'academia',\n\t\t\t\t\t\t\ttimestamp: new Date().toISOString()\n\t\t\t\t\t\t})\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t"},"environment":{"variables":{"NODE_ENV":"development","ENVIRONMENT":"staging","FRONTEND_URL":"https://staging.academia-example.com","CORS_ORIGINS":"https://staging.academia-example.com,http://localhost:3000","DB_SECRET_ARN":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefDbSecret685A0FA57881E1C6"},"DB_HOST":"icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com","DB_PORT":"5432","DB_NAME":"academia","DATABASE_URL":"postgresql://${DB_USER}:${DB_PASS}@icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com:5432/academia","STORAGE_PROVIDER":"s3","AWS_S3_BUCKET":{"Ref":"AssetsBucket5CB76180"},"AWS_S3_REGION":"us-east-1","JWT_SECRET_ARN":{"Ref":"JwtSecretB8834B39"},"STRIPE_SECRET_ARN":{"Ref":"StripeSecret80A38A68"}}},"functionName":"academia-backend-staging","handler":"dist/lambda.handler","memorySize":1024,"role":{"Fn::GetAtt":["BackendFunctionServiceRoleCA938F8D","Arn"]},"runtime":"nodejs20.x","timeout":30,"vpcConfig":{"subnetIds":[{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpcIsolatedSubnet1Subnet2FB46B240A7F37F7"},{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpcIsolatedSubnet2Subnet96BA40FA7DBD9B35"}],"securityGroupIds":[{"Fn::GetAtt":["LambdaSG9DBFCFB7","GroupId"]}]}}}}}},"AcademiaApi":{"id":"AcademiaApi","path":"AcademiaBackend-Staging/AcademiaApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AcademiaApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"Academia API - staging","name":"academia-api-staging"}}},"CloudWatchRole":{"id":"CloudWatchRole","path":"AcademiaBackend-Staging/AcademiaApi/CloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportCloudWatchRole":{"id":"ImportCloudWatchRole","path":"AcademiaBackend-Staging/AcademiaApi/CloudWatchRole/ImportCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AcademiaApi/CloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}]}}}}},"Account":{"id":"Account","path":"AcademiaBackend-Staging/AcademiaApi/Account","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["AcademiaApiCloudWatchRole70B1E378","Arn"]}}}},"Deployment":{"id":"Deployment","path":"AcademiaBackend-Staging/AcademiaApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AcademiaApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"Academia API - staging","restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"DeploymentStage.staging":{"id":"DeploymentStage.staging","path":"AcademiaBackend-Staging/AcademiaApi/DeploymentStage.staging","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AcademiaApi/DeploymentStage.staging/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"AcademiaApiDeployment07DDCC0F33d8dae60d56588ea0eae279818f84de"},"methodSettings":[{"httpMethod":"*","resourcePath":"/*","dataTraceEnabled":false,"throttlingBurstLimit":500,"throttlingRateLimit":1000}],"restApiId":{"Ref":"AcademiaApiEB0FBB35"},"stageName":"staging"}}}}},"Endpoint":{"id":"Endpoint","path":"AcademiaBackend-Staging/AcademiaApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"Default":{"id":"Default","path":"AcademiaBackend-Staging/AcademiaApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.233.0","metadata":[]},"children":{"OPTIONS":{"id":"OPTIONS","path":"AcademiaBackend-Staging/AcademiaApi/Default/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AcademiaApi/Default/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'https://staging.academia-example.com'","method.response.header.Vary":"'Origin'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"responseTemplates":{"application/json":"#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"http://localhost:3000\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Vary":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"resourceId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"{proxy+}":{"id":"{proxy+}","path":"AcademiaBackend-Staging/AcademiaApi/Default/{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ProxyResource","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AcademiaApi/Default/{proxy+}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"pathPart":"{proxy+}","restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}},"OPTIONS":{"id":"OPTIONS","path":"AcademiaBackend-Staging/AcademiaApi/Default/{proxy+}/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AcademiaApi/Default/{proxy+}/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'https://staging.academia-example.com'","method.response.header.Vary":"'Origin'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"responseTemplates":{"application/json":"#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"http://localhost:3000\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Vary":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"resourceId":{"Ref":"AcademiaApiproxyCA83FD4D"},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"ANY":{"id":"ANY","path":"AcademiaBackend-Staging/AcademiaApi/Default/{proxy+}/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"ApiPermission.AcademiaBackendStagingAcademiaApi8F0D2A41.ANY..{proxy+}":{"id":"ApiPermission.AcademiaBackendStagingAcademiaApi8F0D2A41.ANY..{proxy+}","path":"AcademiaBackend-Staging/AcademiaApi/Default/{proxy+}/ANY/ApiPermission.AcademiaBackendStagingAcademiaApi8F0D2A41.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackendFunction63314140","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:771643347382:",{"Ref":"AcademiaApiEB0FBB35"},"/",{"Ref":"AcademiaApiDeploymentStagestaging6A137A14"},"/*/*"]]}}}},"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AcademiaApi/Default/{proxy+}/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["BackendFunction63314140","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"AcademiaApiproxyCA83FD4D"},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}}}},"ANY":{"id":"ANY","path":"AcademiaBackend-Staging/AcademiaApi/Default/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AcademiaApi/Default/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"MOCK"},"resourceId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}}}}}},"ApiUrl":{"id":"ApiUrl","path":"AcademiaBackend-Staging/ApiUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"LambdaFunctionName":{"id":"LambdaFunctionName","path":"AcademiaBackend-Staging/LambdaFunctionName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"AssetsBucketName":{"id":"AssetsBucketName","path":"AcademiaBackend-Staging/AssetsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DatabaseName":{"id":"DatabaseName","path":"AcademiaBackend-Staging/DatabaseName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"AlertTopic":{"id":"AlertTopic","path":"AcademiaBackend-Staging/AlertTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/AlertTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"Academia staging Alerts","topicName":"academia-alerts-staging"}}}}},"LambdaErrorAlarm":{"id":"LambdaErrorAlarm","path":"AcademiaBackend-Staging/LambdaErrorAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/LambdaErrorAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"Lambda function errors for staging environment","alarmName":"academia-staging-lambda-errors","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"FunctionName","value":{"Ref":"BackendFunction63314140"}}],"evaluationPeriods":2,"metricName":"Errors","namespace":"AWS/Lambda","period":300,"statistic":"Sum","threshold":10,"treatMissingData":"notBreaching"}}}}},"LambdaDurationAlarm":{"id":"LambdaDurationAlarm","path":"AcademiaBackend-Staging/LambdaDurationAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/LambdaDurationAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"Lambda function duration exceeds threshold for staging","alarmName":"academia-staging-lambda-duration","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"FunctionName","value":{"Ref":"BackendFunction63314140"}}],"evaluationPeriods":3,"extendedStatistic":"p95","metricName":"Duration","namespace":"AWS/Lambda","period":300,"threshold":10000,"treatMissingData":"notBreaching"}}}}},"LambdaThrottlesAlarm":{"id":"LambdaThrottlesAlarm","path":"AcademiaBackend-Staging/LambdaThrottlesAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/LambdaThrottlesAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"Lambda function throttled for staging","alarmName":"academia-staging-lambda-throttles","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"FunctionName","value":{"Ref":"BackendFunction63314140"}}],"evaluationPeriods":1,"metricName":"Throttles","namespace":"AWS/Lambda","period":300,"statistic":"Sum","threshold":1,"treatMissingData":"notBreaching"}}}}},"Api5xxAlarm":{"id":"Api5xxAlarm","path":"AcademiaBackend-Staging/Api5xxAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/Api5xxAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"API Gateway 5xx errors for staging","alarmName":"academia-staging-api-5xx","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"ApiName","value":"academia-api-staging"}],"evaluationPeriods":2,"metricName":"5XXError","namespace":"AWS/ApiGateway","period":300,"statistic":"Sum","threshold":10,"treatMissingData":"notBreaching"}}}}},"Api4xxAlarm":{"id":"Api4xxAlarm","path":"AcademiaBackend-Staging/Api4xxAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/Api4xxAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"High rate of API Gateway 4xx errors for staging","alarmName":"academia-staging-api-4xx-high","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"ApiName","value":"academia-api-staging"}],"evaluationPeriods":3,"metricName":"4XXError","namespace":"AWS/ApiGateway","period":300,"statistic":"Sum","threshold":50,"treatMissingData":"notBreaching"}}}}},"ApiLatencyAlarm":{"id":"ApiLatencyAlarm","path":"AcademiaBackend-Staging/ApiLatencyAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Staging/ApiLatencyAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"API Gateway latency exceeded for staging","alarmName":"academia-staging-api-latency","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"ApiName","value":"academia-api-staging"}],"evaluationPeriods":3,"extendedStatistic":"p95","metricName":"Latency","namespace":"AWS/ApiGateway","period":300,"threshold":5000,"treatMissingData":"notBreaching"}}}}},"AlertTopicArn":{"id":"AlertTopicArn","path":"AcademiaBackend-Staging/AlertTopicArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaBackend-Staging/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaBackend-Staging/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"Exports":{"id":"Exports","path":"AcademiaBackend-Staging/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Output{\"Ref\":\"AcademiaApiEB0FBB35\"}":{"id":"Output{\"Ref\":\"AcademiaApiEB0FBB35\"}","path":"AcademiaBackend-Staging/Exports/Output{\"Ref\":\"AcademiaApiEB0FBB35\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaBackend-Staging/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaBackend-Staging/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaFrontend-Staging":{"id":"AcademiaFrontend-Staging","path":"AcademiaFrontend-Staging","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"FrontendBucket":{"id":"FrontendBucket","path":"AcademiaFrontend-Staging/FrontendBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Staging/FrontendBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-frontend-staging-771643347382","publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"AcademiaFrontend-Staging/FrontendBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Staging/FrontendBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"FrontendBucketEFE2E19C"},"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}]},{"Action":"s3:GetObject","Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"OAI":{"id":"OAI","path":"AcademiaFrontend-Staging/OAI","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.OriginAccessIdentity","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Staging/OAI/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnCloudFrontOriginAccessIdentity","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::CloudFrontOriginAccessIdentity","aws:cdk:cloudformation:props":{"cloudFrontOriginAccessIdentityConfig":{"comment":"Academia Frontend OAI"}}}}}},"Distribution":{"id":"Distribution","path":"AcademiaFrontend-Staging/Distribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.233.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"AcademiaFrontend-Staging/Distribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Origin2":{"id":"Origin2","path":"AcademiaFrontend-Staging/Distribution/Origin2","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Origin3":{"id":"Origin3","path":"AcademiaFrontend-Staging/Distribution/Origin3","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Resource":{"id":"Resource","path":"AcademiaFrontend-Staging/Distribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::GetAtt":["FrontendBucketEFE2E19C","RegionalDomainName"]},"id":"AcademiaFrontendStagingDistributionOrigin14B001D10","s3OriginConfig":{"originAccessIdentity":{"Fn::Join":["",["origin-access-identity/cloudfront/",{"Ref":"OAIE1EFC67F"}]]}}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"AcademiaBackend-Staging:ExportsOutputRefAcademiaApiEB0FBB3526983528"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"}]]},"id":"AcademiaFrontendStagingDistributionOrigin25FA27BBC","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"AcademiaBackend-Staging:ExportsOutputRefAcademiaApiEB0FBB3526983528"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"}]]},"id":"AcademiaFrontendStagingDistributionOrigin3A7E70AF6","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"AcademiaFrontendStagingDistributionOrigin14B001D10","allowedMethods":["GET","HEAD","OPTIONS"],"cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6","compress":true,"viewerProtocolPolicy":"redirect-to-https"},"cacheBehaviors":[{"pathPattern":"/api/*","targetOriginId":"AcademiaFrontendStagingDistributionOrigin25FA27BBC","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac","viewerProtocolPolicy":"https-only"},{"pathPattern":"/graphql","targetOriginId":"AcademiaFrontendStagingDistributionOrigin3A7E70AF6","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac","viewerProtocolPolicy":"https-only"}],"customErrorResponses":[{"errorCachingMinTtl":300,"errorCode":403,"responseCode":200,"responsePagePath":"/index.html"},{"errorCachingMinTtl":300,"errorCode":404,"responseCode":200,"responsePagePath":"/index.html"}],"defaultRootObject":"index.html","httpVersion":"http2","ipv6Enabled":true,"priceClass":"PriceClass_100"}}}}}},"FrontendUrl":{"id":"FrontendUrl","path":"AcademiaFrontend-Staging/FrontendUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DistributionId":{"id":"DistributionId","path":"AcademiaFrontend-Staging/DistributionId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DistributionDomainName":{"id":"DistributionDomainName","path":"AcademiaFrontend-Staging/DistributionDomainName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"FrontendBucketName":{"id":"FrontendBucketName","path":"AcademiaFrontend-Staging/FrontendBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaFrontend-Staging/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaFrontend-Staging/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaFrontend-Staging/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaFrontend-Staging/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaBackend-Production":{"id":"AcademiaBackend-Production","path":"AcademiaBackend-Production","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"ImportedDbSG":{"id":"ImportedDbSG","path":"AcademiaBackend-Production/ImportedDbSG","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]},"children":{"from AcademiaBackendProductionLambdaSG460F5318:5432":{"id":"from AcademiaBackendProductionLambdaSG460F5318:5432","path":"AcademiaBackend-Production/ImportedDbSG/from AcademiaBackendProductionLambdaSG460F5318:5432","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Allow Lambda production to RDS","fromPort":5432,"groupId":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputFnGetAttDbSecurityGroupE9D701ADGroupId7A7C114A"},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["LambdaSG9DBFCFB7","GroupId"]},"toPort":5432}}}}},"LambdaSG":{"id":"LambdaSG","path":"AcademiaBackend-Production/LambdaSG","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/LambdaSG/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Academia Lambda SG - production","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpc96F0F6140AE947C7"}}}}}},"AssetsBucket":{"id":"AssetsBucket","path":"AcademiaBackend-Production/AssetsBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AssetsBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-assets-production-771643347382","corsConfiguration":{"corsRules":[{"maxAge":3600,"allowedHeaders":["*"],"allowedMethods":["GET","PUT","POST","DELETE"],"allowedOrigins":["https://.academia-example.com","https://api..academia-example.com","http://localhost:3000"]}]},"publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"versioningConfiguration":{"status":"Enabled"}}}}}},"JwtSecret":{"id":"JwtSecret","path":"AcademiaBackend-Production/JwtSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/JwtSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Academia JWT secret - production","generateSecretString":{"passwordLength":64,"excludePunctuation":true},"name":"academia/production/jwt-secret"}}}}},"StripeSecret":{"id":"StripeSecret","path":"AcademiaBackend-Production/StripeSecret","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.Secret","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/StripeSecret/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_secretsmanager.CfnSecret","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SecretsManager::Secret","aws:cdk:cloudformation:props":{"description":"Stripe API keys - production","name":"academia/production/stripe-secret","secretString":"{\"secretKey\":\"\",\"webhookSecret\":\"whsec_placeholder\"}"}}}}},"ImportedDbSecret":{"id":"ImportedDbSecret","path":"AcademiaBackend-Production/ImportedDbSecret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"BackendFunction":{"id":"BackendFunction","path":"AcademiaBackend-Production/BackendFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.233.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"AcademiaBackend-Production/BackendFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"AcademiaBackend-Production/BackendFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaBackend-Production/BackendFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]},{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"AcademiaBackend-Production/BackendFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/BackendFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefDbSecret685A0FA57881E1C6"}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"JwtSecretB8834B39"}},{"Action":["secretsmanager:GetSecretValue","secretsmanager:DescribeSecret"],"Effect":"Allow","Resource":{"Ref":"StripeSecret80A38A68"}},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["AssetsBucket5CB76180","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"BackendFunctionServiceRoleDefaultPolicyA83BBE0A","roles":[{"Ref":"BackendFunctionServiceRoleCA938F8D"}]}}}}}}},"Resource":{"id":"Resource","path":"AcademiaBackend-Production/BackendFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"zipFile":"\n\t\t\t\texports.handler = async (event) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tstatusCode: 200,\n\t\t\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\t\t\tbody: JSON.stringify({ \n\t\t\t\t\t\t\tmessage: 'Academia Backend - Deploy code via CI/CD',\n\t\t\t\t\t\t\tenvironment: 'production',\n\t\t\t\t\t\t\tdatabase: 'academia',\n\t\t\t\t\t\t\ttimestamp: new Date().toISOString()\n\t\t\t\t\t\t})\n\t\t\t\t\t};\n\t\t\t\t};\n\t\t\t"},"environment":{"variables":{"NODE_ENV":"production","ENVIRONMENT":"production","FRONTEND_URL":"https://.academia-example.com","CORS_ORIGINS":"https://.academia-example.com,http://localhost:3000","DB_SECRET_ARN":{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefDbSecret685A0FA57881E1C6"},"DB_HOST":"icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com","DB_PORT":"5432","DB_NAME":"academia","DATABASE_URL":"postgresql://${DB_USER}:${DB_PASS}@icitysystems.cnpejzsnelnc.us-east-1.rds.amazonaws.com:5432/academia","STORAGE_PROVIDER":"s3","AWS_S3_BUCKET":{"Ref":"AssetsBucket5CB76180"},"AWS_S3_REGION":"us-east-1","JWT_SECRET_ARN":{"Ref":"JwtSecretB8834B39"},"STRIPE_SECRET_ARN":{"Ref":"StripeSecret80A38A68"}}},"functionName":"academia-backend-production","handler":"dist/lambda.handler","memorySize":2048,"role":{"Fn::GetAtt":["BackendFunctionServiceRoleCA938F8D","Arn"]},"runtime":"nodejs20.x","timeout":30,"vpcConfig":{"subnetIds":[{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpcIsolatedSubnet1Subnet2FB46B240A7F37F7"},{"Fn::ImportValue":"AcademiaSharedDatabase:ExportsOutputRefSharedVpcIsolatedSubnet2Subnet96BA40FA7DBD9B35"}],"securityGroupIds":[{"Fn::GetAtt":["LambdaSG9DBFCFB7","GroupId"]}]}}}}}},"AcademiaApi":{"id":"AcademiaApi","path":"AcademiaBackend-Production/AcademiaApi","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.RestApi","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AcademiaApi/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnRestApi","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::RestApi","aws:cdk:cloudformation:props":{"description":"Academia API - production","name":"academia-api-production"}}},"CloudWatchRole":{"id":"CloudWatchRole","path":"AcademiaBackend-Production/AcademiaApi/CloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.233.0","metadata":[]},"children":{"ImportCloudWatchRole":{"id":"ImportCloudWatchRole","path":"AcademiaBackend-Production/AcademiaApi/CloudWatchRole/ImportCloudWatchRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.233.0","metadata":[]}},"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AcademiaApi/CloudWatchRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"apigateway.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"]]}]}}}}},"Account":{"id":"Account","path":"AcademiaBackend-Production/AcademiaApi/Account","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnAccount","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Account","aws:cdk:cloudformation:props":{"cloudWatchRoleArn":{"Fn::GetAtt":["AcademiaApiCloudWatchRole70B1E378","Arn"]}}}},"Deployment":{"id":"Deployment","path":"AcademiaBackend-Production/AcademiaApi/Deployment","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Deployment","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AcademiaApi/Deployment/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnDeployment","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Deployment","aws:cdk:cloudformation:props":{"description":"Academia API - production","restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"DeploymentStage.prod":{"id":"DeploymentStage.prod","path":"AcademiaBackend-Production/AcademiaApi/DeploymentStage.prod","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Stage","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AcademiaApi/DeploymentStage.prod/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnStage","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Stage","aws:cdk:cloudformation:props":{"deploymentId":{"Ref":"AcademiaApiDeployment07DDCC0Ffa330974a365864105622c2021709ab3"},"methodSettings":[{"httpMethod":"*","resourcePath":"/*","dataTraceEnabled":false,"throttlingBurstLimit":2500,"throttlingRateLimit":5000}],"restApiId":{"Ref":"AcademiaApiEB0FBB35"},"stageName":"prod"}}}}},"Endpoint":{"id":"Endpoint","path":"AcademiaBackend-Production/AcademiaApi/Endpoint","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"Default":{"id":"Default","path":"AcademiaBackend-Production/AcademiaApi/Default","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ResourceBase","version":"2.233.0","metadata":[]},"children":{"OPTIONS":{"id":"OPTIONS","path":"AcademiaBackend-Production/AcademiaApi/Default/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AcademiaApi/Default/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'https://.academia-example.com'","method.response.header.Vary":"'Origin'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"responseTemplates":{"application/json":"#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"http://localhost:3000\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Vary":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"resourceId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"{proxy+}":{"id":"{proxy+}","path":"AcademiaBackend-Production/AcademiaApi/Default/{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.ProxyResource","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AcademiaApi/Default/{proxy+}/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnResource","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Resource","aws:cdk:cloudformation:props":{"parentId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"pathPart":"{proxy+}","restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}},"OPTIONS":{"id":"OPTIONS","path":"AcademiaBackend-Production/AcademiaApi/Default/{proxy+}/OPTIONS","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AcademiaApi/Default/{proxy+}/OPTIONS/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"apiKeyRequired":false,"authorizationType":"NONE","httpMethod":"OPTIONS","integration":{"type":"MOCK","requestTemplates":{"application/json":"{ statusCode: 200 }"},"integrationResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":"'Content-Type,Authorization,X-Amz-Date,X-Api-Key,X-Amz-Security-Token'","method.response.header.Access-Control-Allow-Origin":"'https://.academia-example.com'","method.response.header.Vary":"'Origin'","method.response.header.Access-Control-Allow-Methods":"'OPTIONS,GET,PUT,POST,DELETE,PATCH,HEAD'","method.response.header.Access-Control-Allow-Credentials":"'true'"},"responseTemplates":{"application/json":"#set($origin = $input.params().header.get(\"Origin\"))\n#if($origin == \"\")\n  #set($origin = $input.params().header.get(\"origin\"))\n#end\n#if($origin == \"http://localhost:3000\")\n  #set($context.responseOverride.header.Access-Control-Allow-Origin = $origin)\n#end"}}]},"methodResponses":[{"statusCode":"204","responseParameters":{"method.response.header.Access-Control-Allow-Headers":true,"method.response.header.Access-Control-Allow-Origin":true,"method.response.header.Vary":true,"method.response.header.Access-Control-Allow-Methods":true,"method.response.header.Access-Control-Allow-Credentials":true}}],"resourceId":{"Ref":"AcademiaApiproxyCA83FD4D"},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}},"ANY":{"id":"ANY","path":"AcademiaBackend-Production/AcademiaApi/Default/{proxy+}/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"ApiPermission.AcademiaBackendProductionAcademiaApiEA45C13A.ANY..{proxy+}":{"id":"ApiPermission.AcademiaBackendProductionAcademiaApiEA45C13A.ANY..{proxy+}","path":"AcademiaBackend-Production/AcademiaApi/Default/{proxy+}/ANY/ApiPermission.AcademiaBackendProductionAcademiaApiEA45C13A.ANY..{proxy+}","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["BackendFunction63314140","Arn"]},"principal":"apigateway.amazonaws.com","sourceArn":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":execute-api:us-east-1:771643347382:",{"Ref":"AcademiaApiEB0FBB35"},"/",{"Ref":"AcademiaApiDeploymentStageprod6317A01C"},"/*/*"]]}}}},"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AcademiaApi/Default/{proxy+}/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"AWS_PROXY","uri":{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":apigateway:us-east-1:lambda:path/2015-03-31/functions/",{"Fn::GetAtt":["BackendFunction63314140","Arn"]},"/invocations"]]},"integrationHttpMethod":"POST"},"resourceId":{"Ref":"AcademiaApiproxyCA83FD4D"},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}}}},"ANY":{"id":"ANY","path":"AcademiaBackend-Production/AcademiaApi/Default/ANY","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.Method","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AcademiaApi/Default/ANY/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_apigateway.CfnMethod","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::ApiGateway::Method","aws:cdk:cloudformation:props":{"authorizationType":"NONE","httpMethod":"ANY","integration":{"type":"MOCK"},"resourceId":{"Fn::GetAtt":["AcademiaApiEB0FBB35","RootResourceId"]},"restApiId":{"Ref":"AcademiaApiEB0FBB35"}}}}}}}}}},"ApiUrl":{"id":"ApiUrl","path":"AcademiaBackend-Production/ApiUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"LambdaFunctionName":{"id":"LambdaFunctionName","path":"AcademiaBackend-Production/LambdaFunctionName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"AssetsBucketName":{"id":"AssetsBucketName","path":"AcademiaBackend-Production/AssetsBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DatabaseName":{"id":"DatabaseName","path":"AcademiaBackend-Production/DatabaseName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"AlertTopic":{"id":"AlertTopic","path":"AcademiaBackend-Production/AlertTopic","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.Topic","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/AlertTopic/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_sns.CfnTopic","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::SNS::Topic","aws:cdk:cloudformation:props":{"displayName":"Academia production Alerts","topicName":"academia-alerts-production"}}}}},"LambdaErrorAlarm":{"id":"LambdaErrorAlarm","path":"AcademiaBackend-Production/LambdaErrorAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/LambdaErrorAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"Lambda function errors for production environment","alarmName":"academia-production-lambda-errors","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"FunctionName","value":{"Ref":"BackendFunction63314140"}}],"evaluationPeriods":2,"metricName":"Errors","namespace":"AWS/Lambda","period":300,"statistic":"Sum","threshold":5,"treatMissingData":"notBreaching"}}}}},"LambdaDurationAlarm":{"id":"LambdaDurationAlarm","path":"AcademiaBackend-Production/LambdaDurationAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/LambdaDurationAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"Lambda function duration exceeds threshold for production","alarmName":"academia-production-lambda-duration","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"FunctionName","value":{"Ref":"BackendFunction63314140"}}],"evaluationPeriods":3,"extendedStatistic":"p95","metricName":"Duration","namespace":"AWS/Lambda","period":300,"threshold":5000,"treatMissingData":"notBreaching"}}}}},"LambdaThrottlesAlarm":{"id":"LambdaThrottlesAlarm","path":"AcademiaBackend-Production/LambdaThrottlesAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/LambdaThrottlesAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"Lambda function throttled for production","alarmName":"academia-production-lambda-throttles","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"FunctionName","value":{"Ref":"BackendFunction63314140"}}],"evaluationPeriods":1,"metricName":"Throttles","namespace":"AWS/Lambda","period":300,"statistic":"Sum","threshold":1,"treatMissingData":"notBreaching"}}}}},"Api5xxAlarm":{"id":"Api5xxAlarm","path":"AcademiaBackend-Production/Api5xxAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/Api5xxAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"API Gateway 5xx errors for production","alarmName":"academia-production-api-5xx","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"ApiName","value":"academia-api-production"}],"evaluationPeriods":2,"metricName":"5XXError","namespace":"AWS/ApiGateway","period":300,"statistic":"Sum","threshold":5,"treatMissingData":"notBreaching"}}}}},"Api4xxAlarm":{"id":"Api4xxAlarm","path":"AcademiaBackend-Production/Api4xxAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/Api4xxAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"High rate of API Gateway 4xx errors for production","alarmName":"academia-production-api-4xx-high","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"ApiName","value":"academia-api-production"}],"evaluationPeriods":3,"metricName":"4XXError","namespace":"AWS/ApiGateway","period":300,"statistic":"Sum","threshold":100,"treatMissingData":"notBreaching"}}}}},"ApiLatencyAlarm":{"id":"ApiLatencyAlarm","path":"AcademiaBackend-Production/ApiLatencyAlarm","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.Alarm","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaBackend-Production/ApiLatencyAlarm/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudwatch.CfnAlarm","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudWatch::Alarm","aws:cdk:cloudformation:props":{"alarmActions":[{"Ref":"AlertTopic2720D535"}],"alarmDescription":"API Gateway latency exceeded for production","alarmName":"academia-production-api-latency","comparisonOperator":"GreaterThanThreshold","dimensions":[{"name":"ApiName","value":"academia-api-production"}],"evaluationPeriods":3,"extendedStatistic":"p95","metricName":"Latency","namespace":"AWS/ApiGateway","period":300,"threshold":3000,"treatMissingData":"notBreaching"}}}}},"AlertTopicArn":{"id":"AlertTopicArn","path":"AcademiaBackend-Production/AlertTopicArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaBackend-Production/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaBackend-Production/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"Exports":{"id":"Exports","path":"AcademiaBackend-Production/Exports","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Output{\"Ref\":\"AcademiaApiEB0FBB35\"}":{"id":"Output{\"Ref\":\"AcademiaApiEB0FBB35\"}","path":"AcademiaBackend-Production/Exports/Output{\"Ref\":\"AcademiaApiEB0FBB35\"}","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaBackend-Production/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaBackend-Production/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"AcademiaFrontend-Production":{"id":"AcademiaFrontend-Production","path":"AcademiaFrontend-Production","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.233.0"},"children":{"FrontendBucket":{"id":"FrontendBucket","path":"AcademiaFrontend-Production/FrontendBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Production/FrontendBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"bucketEncryption":{"serverSideEncryptionConfiguration":[{"serverSideEncryptionByDefault":{"sseAlgorithm":"AES256"}}]},"bucketName":"academia-frontend-production-771643347382","publicAccessBlockConfiguration":{"blockPublicAcls":true,"blockPublicPolicy":true,"ignorePublicAcls":true,"restrictPublicBuckets":true},"versioningConfiguration":{"status":"Enabled"}}}},"Policy":{"id":"Policy","path":"AcademiaFrontend-Production/FrontendBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Production/FrontendBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"FrontendBucketEFE2E19C"},"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*"],"Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}]},{"Action":"s3:GetObject","Effect":"Allow","Principal":{"CanonicalUser":{"Fn::GetAtt":["OAIE1EFC67F","S3CanonicalUserId"]}},"Resource":{"Fn::Join":["",[{"Fn::GetAtt":["FrontendBucketEFE2E19C","Arn"]},"/*"]]}}],"Version":"2012-10-17"}}}}}}}},"OAI":{"id":"OAI","path":"AcademiaFrontend-Production/OAI","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.OriginAccessIdentity","version":"2.233.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"AcademiaFrontend-Production/OAI/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnCloudFrontOriginAccessIdentity","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::CloudFrontOriginAccessIdentity","aws:cdk:cloudformation:props":{"cloudFrontOriginAccessIdentityConfig":{"comment":"Academia Frontend OAI"}}}}}},"Distribution":{"id":"Distribution","path":"AcademiaFrontend-Production/Distribution","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.Distribution","version":"2.233.0","metadata":[]},"children":{"Origin1":{"id":"Origin1","path":"AcademiaFrontend-Production/Distribution/Origin1","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Origin2":{"id":"Origin2","path":"AcademiaFrontend-Production/Distribution/Origin2","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Origin3":{"id":"Origin3","path":"AcademiaFrontend-Production/Distribution/Origin3","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}},"Resource":{"id":"Resource","path":"AcademiaFrontend-Production/Distribution/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_cloudfront.CfnDistribution","version":"2.233.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::CloudFront::Distribution","aws:cdk:cloudformation:props":{"distributionConfig":{"enabled":true,"origins":[{"domainName":{"Fn::GetAtt":["FrontendBucketEFE2E19C","RegionalDomainName"]},"id":"AcademiaFrontendProductionDistributionOrigin10ACFCFB4","s3OriginConfig":{"originAccessIdentity":{"Fn::Join":["",["origin-access-identity/cloudfront/",{"Ref":"OAIE1EFC67F"}]]}}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"AcademiaBackend-Production:ExportsOutputRefAcademiaApiEB0FBB3526983528"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"}]]},"id":"AcademiaFrontendProductionDistributionOrigin2D22FB352","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}},{"domainName":{"Fn::Join":["",[{"Fn::ImportValue":"AcademiaBackend-Production:ExportsOutputRefAcademiaApiEB0FBB3526983528"},".execute-api.us-east-1.",{"Ref":"AWS::URLSuffix"}]]},"id":"AcademiaFrontendProductionDistributionOrigin3A709370B","originPath":"/prod","customOriginConfig":{"originSslProtocols":["TLSv1.2"],"originProtocolPolicy":"https-only"}}],"defaultCacheBehavior":{"pathPattern":"*","targetOriginId":"AcademiaFrontendProductionDistributionOrigin10ACFCFB4","allowedMethods":["GET","HEAD","OPTIONS"],"cachePolicyId":"658327ea-f89d-4fab-a63d-7e88639e58f6","compress":true,"viewerProtocolPolicy":"redirect-to-https"},"cacheBehaviors":[{"pathPattern":"/api/*","targetOriginId":"AcademiaFrontendProductionDistributionOrigin2D22FB352","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac","viewerProtocolPolicy":"https-only"},{"pathPattern":"/graphql","targetOriginId":"AcademiaFrontendProductionDistributionOrigin3A709370B","allowedMethods":["GET","HEAD","OPTIONS","PUT","PATCH","POST","DELETE"],"cachePolicyId":"4135ea2d-6df8-44a3-9df3-4b5a84be39ad","compress":true,"originRequestPolicyId":"b689b0a8-53d0-40ab-baf2-68738e2966ac","viewerProtocolPolicy":"https-only"}],"customErrorResponses":[{"errorCachingMinTtl":300,"errorCode":403,"responseCode":200,"responsePagePath":"/index.html"},{"errorCachingMinTtl":300,"errorCode":404,"responseCode":200,"responsePagePath":"/index.html"}],"defaultRootObject":"index.html","httpVersion":"http2","ipv6Enabled":true,"priceClass":"PriceClass_100"}}}}}},"FrontendUrl":{"id":"FrontendUrl","path":"AcademiaFrontend-Production/FrontendUrl","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DistributionId":{"id":"DistributionId","path":"AcademiaFrontend-Production/DistributionId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"DistributionDomainName":{"id":"DistributionDomainName","path":"AcademiaFrontend-Production/DistributionDomainName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"FrontendBucketName":{"id":"FrontendBucketName","path":"AcademiaFrontend-Production/FrontendBucketName","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.233.0"}},"CDKMetadata":{"id":"CDKMetadata","path":"AcademiaFrontend-Production/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"},"children":{"Default":{"id":"Default","path":"AcademiaFrontend-Production/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.233.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"AcademiaFrontend-Production/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.233.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"AcademiaFrontend-Production/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.233.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.4"}}}}}